---
aliases:
- ELB
- ALB
- NLB
- GLB
---
# Elastic Load Balancer (ELB)
- servers that forward traffic to multiple servers downstream
![[Pasted image 20230818150222.png]]
- expose single point of access [[Technical Terms|DNS]]
- seamlessly handle failures downstream
- conduct health checks
- provide SSL termination for your websites
- enforce stickiness with cookies
- high availability across zones
- separate public traffic from private traffic
- AWS managed load balancer
- integrated with many AWS offerings
## Health Checks
- enable ELB to know is instances are available to forward traffic
- done on a port and a route
- response != 200 means the instance is unhealthy
![[Pasted image 20230818150718.png]]

## Security Groups
![[Pasted image 20230818150822.png]]
![[Pasted image 20230818150859.png]]

## Types
### Classic (CLB)
- HTTP & HTTPS (layer 7), TCP (layer 4), SSL (secure TCP)
- do not use
### Application (ALB)
- HTTP & HTTPS, WebSocket (layer 7)
- multiple HTTP apps across machines (target groups)
- multiple apps on the same machines (containers)
- supports redirects
- app servers don't see the IP of the client directly
	- true IP is inserted into the header **X-Forwarded-For**
![[Pasted image 20230818153319.png]]
#### Routing
- path in URL (example()com/**users** vs. example()com/**posts**)
	- has port mapping feature to redirect to a dynamic port in ECS
	- great fit for **micro services** & **container-based application** (Docker and ECS)
![[Pasted image 20230818152427.png]]
- hostname in URL (**one**.example.com vs. **other**.example.com)
- Query string, headers (example()com/**users?id=123&order=false**)
![[Pasted image 20230818153154.png]]
#### ALB Target Groups
- instances
- ECS tasks
- must be private IPs
### Network (NLB)
- [[Technical Terms|TCP]], TLS (secure TCP), [[Technical Terms|UDP]] (layer 4)
- forward this traffic to your instances
- millions of request per second
- less latency than ALB
- has **one static IP per AZ** and supports assigning [[Technical Terms|Elastic IP]]
- used for extreme performance, not included in free tier
![[Pasted image 20230818153709.png]]
#### NLB Target Groups
- instances
- must be private IPs
- **ALB**
- health checks support **TCP, HTTP, and HTTPS**
![[Pasted image 20230818153904.png]]
### Gateway
- operates at 3 layers (Network layer) - IP protocol (layer 3)
- deploy, scale, manage a fleet of 3rd party network virtual appliances in AWS
- ex. firewalls, intrusion detection, prevention systems, etc.
- combination of:
	- **Transparent Network Gateway**: single entry/exit for all traffic
	- **Load Balancer**
- **Uses GENEVE protocol on port 6081**
![[Pasted image 20230818154211.png]]
#### GLB Target Groups
- instances
- private IPs
## Sticky Sessions (Session Affinity)
- possible to implement stickiness so that the same client is always redirected to the same instance behind a load balancer
- does not work for GLB
- CLB and ALB use cookies
- may bring imbalance to the load over the backend EC2 instances 
### Application based Cookies
#### Custom
- generated by target
- custom attributes required by app
- name must be specified individually for each target group
- ***DON'T*** use **AWSALB, AWSALBAPP, AWSALBTG** (reserved for ELB)
#### Application
- generated by load balancer
- name is **AWSALBAPP**
### Duration based Cookies
- generated by load balancer
- name is **AWSALB** for ALB and **AWSELB** for CLB

## Cross-Zone Load Balancing
![[Pasted image 20230818155113.png]]
### ALB
- enabled by default (can be disabled at TG level)
- no charges for inter AZ data
### NLB & GLB
- disabled by default
- pay charges for inter AZ data if enabled
### CLB
- disabled by default
- no charges for inter AZ if enabled
## SSL Certificates
![[Pasted image 20230818155636.png]]
- uses X.509 certificate
- can manage certificates using ACM
- HTTPS listener:
	- must specify default certificate
	- can add multiple list of certs to support multiple domains
	- can use SNI to specify hostname they reach
	- able to specify a security policy to support older versions of SSL/TLS
### Server Name Indication (SNI)
- solves the problem of loading multiple SSL certs onto one web server (to server multiple websites)
- requires client to indicate the hostname of the target server and the initial SSL handshake
- only works for ALB, NLB and CloudFront
![[Pasted image 20230818160112.png]]


